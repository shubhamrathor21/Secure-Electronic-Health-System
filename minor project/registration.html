<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registration Portal</title>
    <link rel="stylesheet" href="registration.css">
    
</head>
<body>
  
    <div class="container">
        <div class="form-container">
            <h1>Registration Portal</h1>
            <!-- Tabs to select role -->
            <div class="tabs">
                <h3>Select role:</h3>
                <button class="tab-button " data-role="patient" onclick="showForm('patient')">Patient</button>
                <button class="tab-button" data-role="doctor" onclick="showForm('doctor')">Doctor</button>
                <button class="tab-button" data-role="diagnostic" onclick="showForm('diagnostic')">Diagnostic</button>
            </div>

            <!-- Patient Registration Form -->
            <form id="patient-form" >
                <h1>Patient Registration</h1>
                <div class="form-sections">
                <div class="form-section">
                    <div class="form-group">
                        <label for="wallet-address">Wallet Public Address</label>
                        <input type="text" id="wallet-address" value="" readonly>
                    </div>
                    <div class="form-group">
                        <label for="full-name">Full Name</label>
                        <input type="text" id="full-name" value="" required>
                    </div>
                    <div class="form-group">
                        <label for="dob">Date of Birth</label>
                        <input type="date" id="dob" value="" required>
                    </div>
                    <div class="form-group">
                        <label for="p-gender">Gender</label>
                        <select id="p-gender" name="p-gender" required>
                            <option value="">Select</option>
                            <option value="male">Male</option>
                            <option value="female">Female</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="password">Password</label>
                        <input type="password" id="password" value="" required>
                    </div>
                    
                </div>
                <div class="form-section">
                    <div class="form-group">
                        <label for="p-blood">Blood Group</label>
                        <select id="p-blood" name="p-blood" required>
                            <option value="">Select</option>
                            <option value="A+">A+</option>
                            <option value="B+">B+</option>
                            <option value="O+">O+</option>
                            <option value="AB+">AB+</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="address">Home Address</label>
                        <input type="text" id="address" value="" required>
                    </div>
                    <div class="form-group">
                        <label for="hh-number">HH Number</label>
                        <input type="text" id="hh-number" value="" required>
                    </div>
                    <div class="form-group">
                        <label for="email">Email Address</label>
                        <input type="email" id="email" value="" required>
                    </div>
                    <div class="form-group">
                        <label for="confirm-password">Confirm Password</label>
                        <input type="password" id="confirm-password" value="" required>
                    </div>
                </div>
            </div>

                <div class="form-buttons">
                    <button type="submit" class="register-btn">Register</button>
                    <button type="button" class="close-btn" onclick="closeForm()">Close</button>
                </div>
            </form>

            <!-- Doctor Registration Form -->
            <form id="doctor-form">
                <h1>Doctor Registration</h1>
                <div class="form-sections">
                    <div class="form-section">
                        <div class="form-group">
                            
                            <label for="doctor-name">Full Name</label>
                            <input type="text" id="doctor-name" value="" required>
                        </div>
                        <div class="form-group">
                            <label for="doctor-specialty">Specialty</label>
                            <input type="text" id="doctor-specialty" value="" required>
                        </div>
                        <div class="form-group">
                            <label for="doctor-license">License Number</label>
                            <input type="text" id="doctor-license" value="" required>
                        </div>
                        <div class="form-group">
                            <label for="doctor-experience">Years of Experience</label>
                            <input type="number" id="doctor-experience" value="" required>
                        </div>
                        <div class="form-group">
                            <label for="doctor-hospital">Hospital location</label>
                            <input type="text" id="doctor-hospital" value="" required>
                        </div>
                     
                        
                        <div class="form-group">
                            <label for="password">Password</label>
                                <input type="password" id="password" value="" required>
                        </div>
                    </div>
                    
            
                    <div class="form-section">
                       
                        <div class="form-group">                   
                            <label for="doctor-email">Email Address</label>
                            <input type="email" id="doctor-email" value="" required>
                        </div>
                        <div class="form-group">
                            <label for="doctor-phone">Phone Number</label>
                            <input type="tel" id="doctor-phone" value="" required>
                        </div>
                      
                        <div class="form-group">
                            <label for="doctor-hospital">Hospital name</label>
                            <input type="text" id="doctor-hospital" value="" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="doctor-consult-method">Preferred Method of Consultation</label>
                            <select id="doctor-consult-method" required>
                                <option value="">Select</option>
                                <option value="online">Online</option>
                                <option value="in-person">In-person</option>
                                <option value="both">Both</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="p-gender">Gender</label>
                            <select id="p-gender" name="p-gender" required>
                                <option value="">Select</option>
                                <option value="male">Male</option>
                                <option value="female">Female</option>
                                <option value="other">Other</option>
                            </select>
                            
                        </div>
                        <div class="form-group">
                            <label for="confirm-password">Confirm Password</label>
                                <input type="password" id="confirm-password" value="" required>
                        </div>
                    </div>
                </div>
            
                <div class="form-buttons">
                    <button type="submit" class="register-btn">Register</button>
                    <button type="button" class="close-btn" onclick="closeForm()">Close</button>
                </div>
            </form>

            <!-- Diagnostic Registration Form -->
            <form id="diagnostic-form">
                <h1>Diagnostic Registration</h1>
                <div class="form-sections">
                    <div class="form-section">
                        <div class="form-group">
                            <label for="diagnostic-center-name">Center Name</label>
                            <input type="text" id="diagnostic-center-name" value="" required>
                        </div>
                        <div class="form-group">
                            <label for="diagnostic-hospital name">Hospital Name</label>
                            <input type="text" id="diagnostic-hospital name" value="" required>
                        </div>
                        <div class="form-group">
                            <label for="hh-number">HH Number</label>
                            <input type="text" id="hh-number" value="" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="diagnostic-license">License Number</label>
                            <input type="text" id="diagnostic-license" value="" required>
                        </div>
                        <div class="form-group">
                            <label for="password">Password</label>
                                <input type="password" id="password" value="" required>
                        </div>
                    </div>
                    <div class="form-section">
                        <div class="form-group">
                            <label for="diagnostic-address">Center Address</label>
                            <input type="text" id="diagnostic-address" value="" required>
                        </div>
                        <div class="form-group">
                            <label for="diagnostic-email">Email Address</label>
                            <input type="email" id="diagnostic-email" value="" required>
                        </div>
                        <div class="form-group">
                            <label for="diagnostic-locatin">Location</label>
                            <input type="tel" id="diagnostic-location" value="" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="diagnostic-phone">Phone Number</label>
                            <input type="tel" id="diagnostic-phone" value="" required>
                        </div>
                        <div class="form-group">
                            <label for="confirm-password">Confirm Password</label>
                                <input type="password" id="confirm-password" value="" required>
                        </div>
                    
                    </div>
                </div>

                <div class="form-buttons">
                    <button type="submit" class="register-btn">Register</button>
                    <button type="button" class="close-btn" onclick="closeForm()">Close</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        function showForm(role) {
            // Hide all forms
            document.querySelectorAll('form').forEach(form => {
                form.classList.remove('active');
            });
            
            // Show the selected form
            document.getElementById(role + '-form').classList.add('active');
            
            // Hide the tabs and buttons after selection
            document.querySelector('.tabs').style.display = 'none';
        }

        function closeForm() {
            document.querySelector('form.active').reset();
            document.querySelector('form.active').classList.remove('active');
            document.querySelector('.tabs').style.display = 'flex';  // Show the role selection again
        }

        document.addEventListener('DOMContentLoaded', function() {
            const forms = ['patient', 'doctor', 'diagnostic'];
            forms.forEach(formType => {
                document.getElementById(formType + '-form').addEventListener('submit', function(event) {
                    event.preventDefault();
                    alert(formType.charAt(0).toUpperCase() + formType.slice(1) + ' registration successful!');
                });
            });
        });
        async function handleFormSubmit(role, data) {
      try {
        const response = await fetch("http://localhost:5000/register", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ role, data }),
        });
        const result = await response.json();
        alert(result.message || result.error);
      } catch (error) {
        alert("Registration failed: " + error.message);
      }
    }

    function showForm(role) {
      document.querySelectorAll("form").forEach((form) => form.style.display = "none");
      document.getElementById(role + "-form").style.display = "block";
    }

    document.querySelector("#patient-form").addEventListener("submit", (e) => {
      e.preventDefault();
      const data = {
        walletAddress: e.target.walletAddress.value,
        name: e.target.name.value,
        dob: e.target.dob.value,
      };
      handleFormSubmit("patient", data);
    });

    document.querySelector("#doctor-form").addEventListener("submit", (e) => {
      e.preventDefault();
      const data = {
        name: e.target.name.value,
        specialty: e.target.specialty.value,
        license: e.target.license.value,
      };
      handleFormSubmit("doctor", data);
    });

    document.querySelector("#diagnostic-form").addEventListener("submit", (e) => {
      e.preventDefault();
      const data = {
        centerName: e.target.centerName.value,
        license: e.target.license.value,
      };
      handleFormSubmit("diagnostic", data);
    });
    document.addEventListener('DOMContentLoaded', function () {
    document.querySelectorAll("form").forEach((form) => {
      form.addEventListener("submit", async function (event) {
        event.preventDefault();

        // Collect form data
        const formData = new FormData(event.target);
        const data = {};
        formData.forEach((value, key) => {
          data[key] = value;
        });

        // Determine role from form ID
        const role = event.target.id.split("-")[0];

        try {
          const response = await fetch("http://localhost:5000/register", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ role, data }),
          });

          const result = await response.json();
          if (response.ok) {
            alert(result.message);
            window.location.href = role + "dash.html";
          } else {
            alert(result.error);
          }
        } catch (error) {
          console.error("Error:", error);
          alert("Something went wrong!");
        }
      });
    });
  });
    </script>
</body>
</html>
